<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Planner</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <header class="navbar">
    <div class="logo">ONWARD</div>
    <nav class="nav-links">
      <a href="index.html">Home</a>
      <a href="maps.html">Maps</a>
      <a href="#">Community</a>
    </nav>
  </header>

  <main class="planner-layout">

    <!-- Sidebar -->
    <aside class="planner-sidebar">
      <h2>Team Management</h2>

      <div class="team-section">
        <h3>Blue Team</h3>
        <p>Blue 1, Blue 2</p>
      </div>

      <div class="team-section">
        <h3>Red Team</h3>
        <p>Red 1, Red 2</p>
      </div>

      <div class="team-section">
        <h3>Objectives</h3>
        <p>No objectives placed</p>
      </div>
    </aside>

    <!-- Main Map Area -->
    <section class="planner-map">
      <h1 id="map-title">Loading...</h1>
      <img id="map-image" src="" alt="Map Image">

      <!-- Player icons appear here -->
      <div id="player-layer"></div>
    </section>

  </main>

  <script>
    // Read ?map=bazaar from the URL
    const params = new URLSearchParams(window.location.search);
    const map = params.get("map");

    // Map data (with images)
    const mapInfo = {
      bazaar: {
        name: "Bazaar",
        image: "images/bazaar.jpg"
      },
      downfall: {
        name: "Downfall",
        image: "images/downfall.jpg"
      },
      quarantine: {
        name: "Quarantine",
        image: "images/quarantine.jpg"
      },
      subway: {
        name: "Subway",
        image: "images/subway_topdown.png" // change to your custom image
      },
      suburbia: {
        name: "Suburbia",
        image: "images/suburbia.png"
      },
      tanker: {
        name: "Tanker",
        image: "images/tanker.jpg"
      }
    };

    // Update the page with map info
    if (mapInfo[map]) {
      document.getElementById("map-title").textContent = mapInfo[map].name;
      document.getElementById("map-image").src = mapInfo[map].image;
    } else {
      document.getElementById("map-title").textContent = "Unknown Map";
      document.getElementById("map-image").src = "";
    }

    // -------------------------------
    // DRAGGABLE PLAYER SYSTEM
    // -------------------------------

    // Player data
    let players = {
      blue1: { x: 200, y: 200, team: "blue" },
      blue2: { x: 260, y: 200, team: "blue" },
      red1:  { x: 200, y: 300, team: "red" },
      red2:  { x: 260, y: 300, team: "red" }
    };

    // Render players on the map
    function renderPlayers() {
      const layer = document.getElementById("player-layer");
      layer.innerHTML = "";

      for (const id in players) {
        const p = players[id];

        const icon = document.createElement("div");
        icon.className = `player-icon player-${p.team}`;
        icon.textContent = id.toUpperCase();
        icon.style.left = p.x + "px";
        icon.style.top = p.y + "px";

        icon.addEventListener("mousedown", (e) => startDrag(e, id));

        layer.appendChild(icon);
      }
    }

    // Dragging logic
    let dragging = null;
    let offsetX = 0;
    let offsetY = 0;

    function startDrag(e, id) {
      dragging = id;
      offsetX = e.clientX - players[id].x;
      offsetY = e.clientY - players[id].y;

      document.addEventListener("mousemove", dragMove);
      document.addEventListener("mouseup", stopDrag);
    }

    function dragMove(e) {
      if (!dragging) return;

      players[dragging].x = e.clientX - offsetX;
      players[dragging].y = e.clientY - offsetY;

      renderPlayers();
    }

    function stopDrag() {
      dragging = null;
      document.removeEventListener("mousemove", dragMove);
      document.removeEventListener("mouseup", stopDrag);
    }

    // Initial render
    renderPlayers();
  </script>

</body>
</html>
